<div class="object-editor" [ngClass]="{active: room !== null}">
  <div class="close" (click)="close()">
    <i class="fa fa-window-close" aria-hidden="true"></i>
  </div>
  <div *ngIf="room !== null">
    <div class="field name">
      <span class="label">Название комнаты</span>
      <input type="text" [(ngModel)]="room.title">
    </div>

    <div class="field price">
      <span class="label">Цена</span>
      <input type="text" [(ngModel)]="room.price_from">
    </div>

    <div class="field square">
      <span class="label">Площадь</span>
      <input type="text" [(ngModel)]="room.square">
    </div>

    <div class="field description">
      <span class="label">Описание комнаты</span>
      <textarea ngxTrumbowygEditor [(ngModel)]="room.text" [options]="editorOptions"></textarea>
    </div>

    <div class="field images">
      <span class="label">Изображения</span>

      <div *ngIf="roomImages.length === 0">
        <div class="image-card" (click)="chooser.showPopup()">
          <div class="new-image image-wrapper">
            Добавить еще<br>
            <i class="plus"></i><br>
          </div>
        </div>
      </div>

      <ng-template #imageTemplate let-item="item" let-index="index">
        <div class="image-card" (click)="chooser.showPopup()" *ngIf="index === 0">
          <div class="new-image image-wrapper">
            Добавить еще<br>
            <i class="plus"></i><br>
          </div>
        </div>
        <div class="image-card" (click)="chooser.showFastEditor(item.value)">
          <div class="image-card-wrapper">
            <img #imagesList [src]="'/' + item.value.filename" (load)="detectOrientation(index)">
          </div>
          <span class="delete" (click)="removeImage(item.value)">
            <i class="fa fa-close"></i>
          </span>
        </div>
      </ng-template>

      <bs-sortable #sortable
              [(ngModel)]="roomImages"
              [itemTemplate]="imageTemplate"
              itemClass="sortable-item-unset"
              itemActiveClass="sortable-item-active"
      ></bs-sortable>

      <app-image-chooser-popup #chooser (selectedImageIds)="appendImages($event)" [multiple]="true"></app-image-chooser-popup>
    </div>

    <div class="field alias">
      <span class="label">Путь URL</span>
      <input type="text" [(ngModel)]="room.alias">
    </div>

    <div class="field published">
      <span class="label">Опубликован</span>
      <mat-checkbox [color]="'primary'" [(ngModel)]="room.published"></mat-checkbox>
    </div>

    <div class="buttons">
      <button type="button" class="ripple module-control-button-element default" (click)="save()">Сохранить</button>
      <button type="button" class="ripple module-control-button-element delete" (click)="openModal(confirmDelete)">Удалить</button>
    </div>
  </div>
</div>
<ng-template #imageChoose>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Выберите изображение</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <app-image-chooser (selectedImageId)="selectImage($event)"></app-image-chooser>
    <button class="btn btn-primary">выбор</button>
    <button class="btn btn-danger" (click)="modalRef.hide()">отмена</button>
  </div>
</ng-template>
<ng-template #confirmDelete>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Вы точно хотите удалить этот номер?</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="buttons">
      <button class="ripple module-control-button-element cancel" (click)="modalRef.hide()">отмена</button>
      <button class="ripple module-control-button-element delete" (click)="delete()">да, удалить</button>
    </div>
  </div>
</ng-template>